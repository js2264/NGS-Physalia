[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Epigenomics Data Analysis",
    "section": "",
    "text": "Welcome\nThis is the landing page for the “Epigenomics Data Analysis” workshop, ed. 2023.\nAuthors: Jacques Serizay [aut, cre] Version: 1.0.0 Modified: 2023-06-14 Compiled: 2023-07-19 Environment: R version 4.3.1 (2023-06-16), Bioconductor 3.17 License: MIT + file LICENSE Copyright: J. Serizay"
  },
  {
    "objectID": "index.html#what",
    "href": "index.html#what",
    "title": "Epigenomics Data Analysis",
    "section": "What",
    "text": "What\nThis course will introduce biologists and bioinformaticians to the field of regulatory epigenomics. We will cover a range of software and analysis workflows for processing of next-generation sequencing datasets and quantitative analysis ChIP-seq, ATAC-seq data and RNA-seq data. Towards the end of the workshop, a brief introduction to chromatin conformation capture (Hi-C) experiments and analysis will emphasize multi-omics data integration.\nWe will start by introducing general concepts about epigenomics. From there, we will then continue to describe the main analysis steps to go from raw sequencing data to processed and usable data. We will present classical analysis workflows, their output and the possible paths to investigate downstream of this.\nThroughout the workshop, bash tools and R/Bioconductor packages will be used to analyse datasets and learn new approaches."
  },
  {
    "objectID": "index.html#when",
    "href": "index.html#when",
    "title": "Epigenomics Data Analysis",
    "section": "When",
    "text": "When\n\nJuly 3 (Monday)\nJuly 5 (Wednesday)\nJuly 7 (Friday)\nJuly 17 (Monday)\nJuly 19 (Wednesday)"
  },
  {
    "objectID": "index.html#where",
    "href": "index.html#where",
    "title": "Epigenomics Data Analysis",
    "section": "Where",
    "text": "Where\nThis course will be held online."
  },
  {
    "objectID": "index.html#how",
    "href": "index.html#how",
    "title": "Epigenomics Data Analysis",
    "section": "How",
    "text": "How\nThe course is structured in modules over five days. Each day will contain a mix of formal lectures, demonstration, and hands-on exercises.\n\nDuring the first half daily sessions, formal lectures and demonstrations will cover the key theory required to understand the principles of next-generation sequencing dataset processing and analysis. This will illustrate real-life processing and analysis workflows. At this stage, trainees will get acquainted with state-of-the-art Bioconductor ecosystem as well as the best coding practices in bioinformatics.\nDuring the second half of daily sessions, trainees will work by themselves. Guided exercise notebooks will be provided, including hints and solutions for each exercise. The exercises will mainly focus on specific concepts introduced earlier that day.\nOffice hours will take place during the last hour of the exercises. The instructor will be available to answer individual questions related to daily exercises.\n\nA Slack channel will be available so that Q&A are available for everybody."
  },
  {
    "objectID": "index.html#who",
    "href": "index.html#who",
    "title": "Epigenomics Data Analysis",
    "section": "Who",
    "text": "Who\nThe course is aimed at researchers interested in learning how to extract biological insights from genomics data, such as ChIP-seq, ATAC-seq or Hi-C.\nIt is primarily targeting researchers who are relatively new to the field of bioinformatics, with practical experience in the experimental side of epigenomics.\nAttendees should have a background in biology as well as be familiar with genomic data and common file formats from NGS sequencing experiments (fastq, BAM, BED).\nPractical exercises will use command-line Linux and R code and will be presented as notebooks to ensure reproducible coding."
  },
  {
    "objectID": "index.html#why",
    "href": "index.html#why",
    "title": "Epigenomics Data Analysis",
    "section": "Why",
    "text": "Why\nAt the end of this course, you should be able to:\n\nUnderstanding important genomic file formats\nProcess most types of genomic datasets (RNA-seq, ATAC-seq, Hi-C, ChIP-seq, …)\nAnalyzing processed datasets to extract relevant information and answer biological questions\nGood practices to avoid confounding variables and pitfalls in the processing.\nProper use of controls and normalization.\nIntegration of different sequencing “omics” datasets\nCharacterisation of the global 3D structures from the sequencing data\nDetection of regulatory interactions and quantification of their changes between conditions.\n\nThroughout the course, we will also have a focus on reproducible research, documented content and interactive reports."
  },
  {
    "objectID": "index.html#instructors",
    "href": "index.html#instructors",
    "title": "Epigenomics Data Analysis",
    "section": "Instructors",
    "text": "Instructors\nJacques Serizay"
  },
  {
    "objectID": "content/program.html#day-1---next-generation-sequencing-data-processing",
    "href": "content/program.html#day-1---next-generation-sequencing-data-processing",
    "title": "Program",
    "section": "Day 1 - Next-generation sequencing data processing",
    "text": "Day 1 - Next-generation sequencing data processing\n\nLectures\n\nLecture 1: Epigenomics introduction\nLecture 2: General processing of NGS data\n\n\n\nDemo\n\nFetching an MNase-seq dataset from GEO\nIndexing a genome with bowtie2\nMap paired-end reads with bowtie2\nGenerate sequencing-depth normalized track\nGenerate nucleosomes track\n\n\n\nLabs\n\nFetching an MNase-seq dataset from GEO\nIndexing a genome with bowtie2\nMap paired-end reads with bowtie2\nGenerate sequencing-depth normalized track\nGenerate nucleosomes track\nCheck the relevance of filtering out duplicates"
  },
  {
    "objectID": "content/program.html#day-2---atac-seq",
    "href": "content/program.html#day-2---atac-seq",
    "title": "Program",
    "section": "Day 2 - ATAC-seq",
    "text": "Day 2 - ATAC-seq\n\nLectures\n\nLecture 3: NGS worfklows: bash, Snakemake, Nextflow, …\nLecture 4: ATAC-seq processing\nLecture 5: R/Bioconductor 101: Data import, manipulating genomic ranges, …\n\n\n\nDemo\n\nFetching two ATAC-seq replicates from GEO\nIndexing a genome with bowtie2\nMap paired-end reads with bowtie2\nGenerate sequencing-depth normalized track\nCalling peaks form ATAC-seq data\n\n\n\nLabs\n\nOverlap ATAC-seq peaks with annotated REs\nCheck ATAC-seq fragment sizes\nOverlap ATAC-seq peaks with annotated regulatory elements (REs)\nCheck tissue-specific enrichment of ATAC-seq peaks"
  },
  {
    "objectID": "content/program.html#day-3---chip-seq-analysis",
    "href": "content/program.html#day-3---chip-seq-analysis",
    "title": "Program",
    "section": "Day 3 - ChIP-seq analysis",
    "text": "Day 3 - ChIP-seq analysis\n\nLectures\n\nLecture 6: ChIP-seq processing\nLecture 7: R/Bioconductor 201: Rle, SummarizedExperiment, …\n\n\n\nDemo\n\nManually process Scc1 ChIP-seq reads\nGenerate IP/input ratios with bamCoverage\nCall peaks and inspect them visually\n\n\n\nLabs\n\nFind motifs enriched in a set of ChIP-seq peaks\nImport a dozen of ChIP-seq peak sets in R\nCheck distribution of peaks comapred to genomic features\nCheck peak occurrence over tissue-specific regulatory elements"
  },
  {
    "objectID": "content/program.html#day-4---rna-seq-analysis",
    "href": "content/program.html#day-4---rna-seq-analysis",
    "title": "Program",
    "section": "Day 4 - RNA-seq analysis",
    "text": "Day 4 - RNA-seq analysis\n\nLectures\n\nLecture 8: RNA-seq processing\nLecture 9: R/Bioconductor 301: Databases, resources, …\n\n\n\nDemo\n\nManually process RNA-seq reads\nGenerate stranded RNA-seq tracks with bamCoverage\nEstimate transcript abundance with featureCounts\n\n\n\nLabs\n\nManually process RNA-seq reads\nGenerate stranded RNA-seq tracks with bamCoverage\nEstimate transcript abundance with summarizeOverlaps"
  },
  {
    "objectID": "content/program.html#day-5---data-integration-and-multi-omics",
    "href": "content/program.html#day-5---data-integration-and-multi-omics",
    "title": "Program",
    "section": "Day 5 - Data integration and multi-omics",
    "text": "Day 5 - Data integration and multi-omics\n\nLectures\n\nLecture 10: Hi-C processing\nLecture 11: GO and GSEA analyses\n\n\n\nDemo\n\nRecovering chromatin states from the AnnotationHub\nIntersecting GRanges\nRecovering genes from genomic loci\nPerforming GO analysis\n\n\n\nLabs\n\nVisually inspect results from MNase-seq, Scc1 ChIP-seq and RNA-seq in yeast\nPlot profiles of MNase-seq coverage @ TSSs\nPlot profiles of RNA-seq @ Scc1 ChIP-seq"
  },
  {
    "objectID": "content/Rstudio.html",
    "href": "content/Rstudio.html",
    "title": "RStudio",
    "section": "",
    "text": "Rstudio offers a graphical interface to facilitate the interaction between a user and an underlying programming language (this is sometimes called IDE, or integrated development environment). It can be very useful when a user is not necessarily proficent with command line-based computing. However, such graphical interfaces are not always able to connect to services such as AWS."
  },
  {
    "objectID": "content/prerequisites.html#local-configuration",
    "href": "content/prerequisites.html#local-configuration",
    "title": "Prerequisites",
    "section": "Local configuration",
    "text": "Local configuration\n\nComputer with high-speed internet access\nZoom visioconference software\nFor Windows users: PLEASE INSTALL WSL 2. Instructions are here: learn.microsoft.com/en-us/windows/wsl/install\n\n\n\nIGV software installed\nSeveral system dependencies\n\nR&gt;=4.1: https://cloud.r-project.org/\nfastqc: https://www.bioinformatics.babraham.ac.uk/projects/fastqc/\ncutadapt: https://cutadapt.readthedocs.io/en/stable/installation.html\ntrim_galore: https://github.com/FelixKrueger/TrimGalore\nbowtie2: https://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#obtaining-bowtie-2\ndeepTools: https://deeptools.readthedocs.io/en/develop/content/installation.html\nmacs2: https://github.com/macs3-project/MACS/wiki/Install-macs2#easy-installation-through-pypi\nmeme: https://meme-suite.org/meme/doc/install.html?man_type=web\nsubread: https://subread.sourceforge.net/\n\n\n\n\n\n\n\n\nInstalling system dependencies with micromamba\n\n\n\nmicromamba is a blazing-fast flavour of conda, a software manager available in Mac and Linux. micromamba sets up environments, directories in your computer in which micromamba installs softwares only available upon environment activation.\nTo install micromamba and system dependencies listed hereabove, use the following:\n\n\n\nsh\n\n# apt update && apt install -y bzip2 curl wget\ncurl micro.mamba.pm/install.sh | bash\nbash\nmicromamba create -n epigenomics\nmicromamba activate epigenomics\nmicromamba install -c bioconda -c conda-forge \\\n    fastqc fastqc trim-galore bowtie2 deepTools macs2 meme subread star samtools bedtools \\\n    mawk tree java-jdk ucsc-bedGraphToBigWig \\\n    pandas numpydoc matplotlib cooler cooltools hicstuff\n\n\n\n\n\nSeveral R packages, the main ones being:\n\nBiocManager\nSummarizedExperiment\nrtracklayer\nGenomicRanges\nGenomicAlignments\nGenomicFeatures\nDESeq2\ngprofiler2"
  },
  {
    "objectID": "content/day1/Lecture1_introduction.html",
    "href": "content/day1/Lecture1_introduction.html",
    "title": "1  Lecture 1 - Introduction to epigenomics data analysis",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-faba582bb439d5cd836a674b446052c1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-206d9bdacd2687331926375f626b36d4\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/prerequisites.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;Prerequisites&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day1/Lecture2_processing.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;2&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day1/Lecture2_processing.html",
    "href": "content/day1/Lecture2_processing.html",
    "title": "2  Lecture 2 - General processing of genome-wide epigenomic assays",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-faba582bb439d5cd836a674b446052c1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-117839f07458e2f4afe2f66310b16745\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day1/Lecture1_introduction.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;1&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day1/Demo1_MNase-seq_processing.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;3&lt;/span&gt;  &lt;span class='chapter-title'&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day1/Demo1_MNase-seq_processing.html#getting-data",
    "href": "content/day1/Demo1_MNase-seq_processing.html#getting-data",
    "title": "3  Demo 1 - Processing of MNase-seq data",
    "section": "3.1 Getting data",
    "text": "3.1 Getting data\n\n3.1.1 Downloading reads from internet\nWe can download the paired-end reads (R1 and R2 fastq files) directly from the internet.\n\n\n\nsh\n\ncd ~/EpigenomicsDataAnalysis_2023\nmkdir data/\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR319/002/SRR3193262/SRR3193262_1.fastq.gz -o data/MNase_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR319/002/SRR3193262/SRR3193262_2.fastq.gz -o data/MNase_R2.fq.gz\n\n\n\n\n3.1.2 FastQC reads\nfastqc program will run quick QCs on each fastq file separately.\n\n\n\nsh\n\nmkdir data/fastqc\nfastqc \\\n    --outdir data/fastqc \\\n    --noextract \\\n    --threads 12 \\\n    --adapters /home/rsg/repos/autobcl2fastq/adapters.txt \\\n    data/*fq.gz 1&gt;&2"
  },
  {
    "objectID": "content/day1/Demo1_MNase-seq_processing.html#pre-process-reads",
    "href": "content/day1/Demo1_MNase-seq_processing.html#pre-process-reads",
    "title": "3  Demo 1 - Processing of MNase-seq data",
    "section": "3.2 Pre-process reads",
    "text": "3.2 Pre-process reads\n\n3.2.1 Trimming reads with trim_galore\n\n\n\nsh\n\ntrim_galore \\\n    --cores 8 \\\n    --length 20 \\\n    --gzip \\\n    --paired \\\n    --output_dir data/trimmed/ \\\n    data/MNase_R1.fq.gz data/MNase_R2.fq.gz\n\n\n\n\n3.2.2 FastQC on trimmed reads\n\n\n\nsh\n\nfastqc \\\n    --outdir data/fastqc \\\n    --noextract \\\n    --threads 12 \\\n    --adapters /home/rsg/repos/autobcl2fastq/adapters.txt \\\n    data/trimmed/*fq.gz 1&gt;&2"
  },
  {
    "objectID": "content/day1/Demo1_MNase-seq_processing.html#align-reads-to-a-genome-reference",
    "href": "content/day1/Demo1_MNase-seq_processing.html#align-reads-to-a-genome-reference",
    "title": "3  Demo 1 - Processing of MNase-seq data",
    "section": "3.3 Align reads to a genome reference",
    "text": "3.3 Align reads to a genome reference\n\n3.3.1 Indexing sacCer3 genome\nGenome references for model systems can be fetched from iGenomes.\n\n\n\nsh\n\n## - Fetching data from iGenomes\nmkdir data/genome\ncurl -L http://igenomes.illumina.com.s3-website-us-east-1.amazonaws.com/Saccharomyces_cerevisiae/Ensembl/R64-1-1/Saccharomyces_cerevisiae_Ensembl_R64-1-1.tar.gz -o data/genome/R64-1-1.tar.gz\n\n## - Unpacking data \ntar -C data/genome/ -xzf data/genome/R64-1-1.tar.gz\ncp data/genome/Saccharomyces_cerevisiae/Ensembl/R64-1-1/Sequence/WholeGenomeFasta/genome.fa data/genome/R64-1-1.fa\ncp data/genome/Saccharomyces_cerevisiae/Ensembl/R64-1-1/Annotation/Genes/genes.gtf data/genome/R64-1-1.gtf\n\n## - Indexing genome\nbowtie2-build data/genome/R64-1-1.fa data/genome/R64-1-1\n\n\n\n\n3.3.2 Mapping paired-end trimmed reads\n\n\n\nsh\n\n## - Mapping fastq files to reference genome\nmkdir data/mapping\nbowtie2 \\\n    --threads 16 \\\n    -x data/genome/R64-1-1 \\\n    -1 data/trimmed/MNase_R1_val_1.fq.gz \\\n    -2 data/trimmed/MNase_R2_val_2.fq.gz \\\n    &gt; data/mapping/MNase_R64-1-1.sam\n\n\n\n\n3.3.3 Filtering mapped fragments\n\n\n\nsh\n\n## - Fixing mates\n#| -m: \"Add mate score tag\"\nsamtools fixmate \\\n    -@ 16 --output-fmt bam \\\n    -m \\\n    data/mapping/MNase_R64-1-1.sam data/mapping/MNase_R64-1-1.bam\n\n## - Sorting read pairs\nsamtools sort \\\n    -@ 16 --output-fmt bam \\\n    data/mapping/MNase_R64-1-1.bam \\\n    -o data/mapping/MNase_R64-1-1_sorted.bam \n\n## - Removing PCR & optical duplicates\n#| -s: \"Report stats\"\n#| -r: \"Remove duplicate reads\"\nsamtools markdup \\\n    -@ 16 --output-fmt bam \\\n    -s -r \\\n    data/mapping/MNase_R64-1-1_sorted.bam \\\n    data/mapping/MNase_R64-1-1_sorted_noDups.bam \n\n## - Filter read pairs\n#| -f 0x001: \"Keep read paired\"\n#| -f 0x002: \"Keep read mapped in proper pair\"\n#| -F 0x004: \"Remove read unmapped\"\n#| -F 0x008: \"Remove mate unmapped\"\n#| -q 10: \"MAPQ &gt; 20\"\n#| --fast: \"Use fast bam compression\"\nsamtools view \\\n    -@ 16 --output-fmt bam \\\n    -f 0x001 -f 0x002 -F 0x004 -F 0x008 -q 20 \\\n    --fast \\\n    data/mapping/MNase_R64-1-1_sorted_noDups.bam \\\n    -o data/mapping/MNase_R64-1-1_sorted_noDups_filtered.bam\n\n## - Sorting read pairs\n#| -l 9: \"Use best compression \"\nsamtools sort \\\n    -@ 16 --output-fmt bam \\\n    -l 9 \\\n    data/mapping/MNase_R64-1-1_sorted_noDups_filtered.bam \\\n    -o data/mapping/MNase_R64-1-1_sorted_noDups_filtered_sorted.bam\n\n## - Indexing bam file\nsamtools index -@ 16 data/mapping/MNase_R64-1-1_sorted_noDups_filtered_sorted.bam\n\n\n\n\n3.3.4 Create coverage track\n\n\n\nsh\n\n## - Generate coverage\nmkdir data/tracks\nbamCoverage \\\n    --bam data/mapping/MNase_R64-1-1_sorted_noDups_filtered_sorted.bam \\\n    --outFileName data/tracks/MNase_R64-1-1_sorted_noDups_filtered_sorted.CPM.bw \\\n    --binSize 1 \\\n    --numberOfProcessors 16 \\\n    --normalizeUsing CPM \\\n    --skipNonCoveredRegions \\\n    --extendReads\n\n\n\n\n3.3.5 Create nucleosome track\n\n\n\nsh\n\nbamCoverage \\\n    --bam data/mapping/MNase_R64-1-1_sorted_noDups_filtered_sorted.bam \\\n    --outFileName data/tracks/MNase_R64-1-1_sorted_noDups_filtered_sorted.135-160bp.CPM.bw \\\n    --binSize 1 \\\n    --numberOfProcessors 16 \\\n    --normalizeUsing CPM \\\n    --skipNonCoveredRegions \\\n    --extendReads 40 \\\n    --centerReads \\\n    --minFragmentLength 130 \\\n    --maxFragmentLength 165"
  },
  {
    "objectID": "content/day1/Lab1_MNase-seq_processing.html#getting-data",
    "href": "content/day1/Lab1_MNase-seq_processing.html#getting-data",
    "title": "4  Lab 1 - Processing of MNase-seq data",
    "section": "4.1 Getting data",
    "text": "4.1 Getting data\n\n4.1.1 Downloading reads from internet\nWe can download the paired-end reads (R1 and R2 fastq files) directly from the internet.\n\nFind the download links associated with the SRR3193263 SRR ID. You can go to SRA-explorer to easily recover links.\nDownload the two fastq files for the SRR3193263 SRR ID.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\ncd ~/EpigenomicsDataAnalysis_2023\nmkdir data/\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR319/003/SRR3193263/SRR3193263_1.fastq.gz -o data/MNase_2.5min_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR319/003/SRR3193263/SRR3193263_2.fastq.gz -o data/MNase_2.5min_R2.fq.gz\n\n\n\n\n\n\n\n4.1.2 FastQC reads\n\nRun fastqc on each fastq file individually.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\nmkdir data/fastqc\nfastqc \\\n    --outdir data/fastqc \\\n    --noextract \\\n    --threads 12 \\\n    data/*fq.gz 1&gt;&2"
  },
  {
    "objectID": "content/day1/Lab1_MNase-seq_processing.html#pre-process-reads",
    "href": "content/day1/Lab1_MNase-seq_processing.html#pre-process-reads",
    "title": "4  Lab 1 - Processing of MNase-seq data",
    "section": "4.2 Pre-process reads",
    "text": "4.2 Pre-process reads\n\n4.2.1 Trimming reads with trim_galore\n\nDid you find any adapter contamination in the two original fastq files?\nIf so, proceed to fastq file trimming with cutadapt. Read its doc to see how to automatically run fastqc after trimming reads.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\ntrim_galore \\\n    --cores 8 \\\n    --length 20 \\\n    --gzip \\\n    --paired \\\n    --fastqc \\\n    --fastqc_args \"--outdir data/fastqc --noextract --threads 12\" \\\n    --output_dir data/trimmed/ \\\n    data/MNase_2.5min_R1.fq.gz data/MNase_2.5min_R2.fq.gz"
  },
  {
    "objectID": "content/day1/Lab1_MNase-seq_processing.html#align-reads-to-a-genome-reference",
    "href": "content/day1/Lab1_MNase-seq_processing.html#align-reads-to-a-genome-reference",
    "title": "4  Lab 1 - Processing of MNase-seq data",
    "section": "4.3 Align reads to a genome reference",
    "text": "4.3 Align reads to a genome reference\n\n4.3.1 Indexing sacCer3 genome\nGenome references for model systems can be fetched from iGenomes.\n\nBuild S. cerevisiae genome (R64-1-1) bowtie2 index.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\n## - Fetching data from iGenomes\nmkdir data/genome\ncurl -L http://igenomes.illumina.com.s3-website-us-east-1.amazonaws.com/Saccharomyces_cerevisiae/Ensembl/R64-1-1/Saccharomyces_cerevisiae_Ensembl_R64-1-1.tar.gz -o data/genome/R64-1-1.tar.gz\n\n## - Unpacking data \ntar -C data/genome/ -xzf data/genome/R64-1-1.tar.gz\ncp data/genome/Saccharomyces_cerevisiae/Ensembl/R64-1-1/Sequence/WholeGenomeFasta/genome.fa data/genome/R64-1-1.fa\ncp data/genome/Saccharomyces_cerevisiae/Ensembl/R64-1-1/Annotation/Genes/genes.gtf data/genome/R64-1-1.gtf\n\n## - Indexing genome\nbowtie2-build data/genome/R64-1-1.fa data/genome/R64-1-1\n\n\n\n\n\n\n\n4.3.2 Mapping paired-end trimmed reads\n\nMap paired-end reads with bowtie2.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\n## - Mapping fastq files to reference genome\nmkdir data/mapping\nbowtie2 \\\n    --threads 16 \\\n    -x data/genome/R64-1-1 \\\n    -1 data/trimmed/MNase_2.5min_R1_val_1.fq.gz \\\n    -2 data/trimmed/MNase_2.5min_R2_val_2.fq.gz \\\n    &gt; data/mapping/MNase_2.5min_R64-1-1.sam\n\n\n\n\n\n\n\n4.3.3 Filtering mapped fragments\n\nFilter mapped pairs using the following procedure:\n\nFixing mates\nSorting reads\nRemoving duplicates\nFiltering pairs:\n\nOnly keep paired reads (0x001)\nOnly keep reads mapped in proper pair (0x002)\nNo unmapped reads (0x004)\nNo reads with unmapped mate (0x008)\nReads mapped with a MAPQ &gt;= 20\n\nSorting reads\nIndexing reads\n\n\nTo better understand the combinations of information described by the SAM “flag”, check the Decoding SAM flags page.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\n## - Fixing mates\n#| -m: \"Add mate score tag\"\nsamtools fixmate \\\n    -@ 16 --output-fmt bam \\\n    -m \\\n    data/mapping/MNase_2.5min_R64-1-1.sam data/mapping/MNase_2.5min_R64-1-1.bam\n\n## - Sorting read pairs\nsamtools sort \\\n    -@ 16 --output-fmt bam \\\n    data/mapping/MNase_2.5min_R64-1-1.bam \\\n    -o data/mapping/MNase_2.5min_R64-1-1_sorted.bam \n\n## - Removing PCR & optical duplicates\n#| -s: \"Report stats\"\n#| -r: \"Remove duplicate reads\"\nsamtools markdup \\\n    -@ 16 --output-fmt bam \\\n    -s -r \\\n    data/mapping/MNase_2.5min_R64-1-1_sorted.bam \\\n    data/mapping/MNase_2.5min_R64-1-1_sorted_noDups.bam \n\n## - Filter read pairs\n#| -f 0x001: \"Keep read paired\"\n#| -f 0x002: \"Keep read mapped in proper pair\"\n#| -F 0x004: \"Remove read unmapped\"\n#| -F 0x008: \"Remove mate unmapped\"\n#| -q 20: \"MAPQ &gt;= 20\"\n#| --fast: \"Use fast bam compression\"\nsamtools view \\\n    -@ 16 --output-fmt bam \\\n    -f 0x001 -f 0x002 -F 0x004 -F 0x008 -q 20 \\\n    --fast \\\n    data/mapping/MNase_2.5min_R64-1-1_sorted_noDups.bam \\\n    -o data/mapping/MNase_2.5min_R64-1-1_sorted_noDups_filtered.bam\n\n## - Sorting read pairs\n#| -l 9: \"Use best compression \"\nsamtools sort \\\n    -@ 16 --output-fmt bam \\\n    -l 9 \\\n    data/mapping/MNase_2.5min_R64-1-1_sorted_noDups_filtered.bam \\\n    -o data/mapping/MNase_2.5min_R64-1-1_sorted_noDups_filtered_sorted.bam\n\n## - Indexing bam file\nsamtools index -@ 16 data/mapping/MNase_2.5min_R64-1-1_sorted_noDups_filtered_sorted.bam\n\n\n\n\n\n\n\n4.3.4 Create coverage track\n\nCreate a sequencing depth-normalized track, filling out fragments.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\n## - Generate coverage\nmkdir data/tracks\nbamCoverage \\\n    --bam data/mapping/MNase_2.5min_R64-1-1_sorted_noDups_filtered_sorted.bam \\\n    --outFileName data/tracks/MNase_2.5min_R64-1-1_sorted_noDups_filtered_sorted.CPM.bw \\\n    --binSize 1 \\\n    --numberOfProcessors 16 \\\n    --normalizeUsing CPM \\\n    --skipNonCoveredRegions \\\n    --extendReads\n\n\n\n\n\n\n\n4.3.5 Create nucleosome track\n\nCreate a nucleosome track by keeping the fragments between 130 and 165bp, and extending them to 40bp aligned at their center.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\nbamCoverage \\\n    --bam data/mapping/MNase_2.5min_R64-1-1_sorted_noDups_filtered_sorted.bam \\\n    --outFileName data/tracks/MNase_2.5min_R64-1-1_sorted_noDups_filtered_sorted.135-160bp.CPM.bw \\\n    --binSize 1 \\\n    --numberOfProcessors 16 \\\n    --normalizeUsing CPM \\\n    --skipNonCoveredRegions \\\n    --extendReads 40 \\\n    --centerReads \\\n    --minFragmentLength 130 \\\n    --maxFragmentLength 165\n\n\n\n\n\n\n\n4.3.6 Create coverage track without removing duplicates\n\nReprocess the bam file to generate coverage and nucleosome tracks from fragments without removing the read duplicates.\nCompare the different tracks generated in IGV. Comment.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\n## - Filter read pairs\n#| -f 0x001: \"Keep read paired\"\n#| -f 0x002: \"Keep read mapped in proper pair\"\n#| -F 0x004: \"Remove read unmapped\"\n#| -F 0x008: \"Remove mate unmapped\"\n#| -q 10: \"MAPQ &gt; 20\"\n#| --fast: \"Use fast bam compression\"\nsamtools view \\\n    -@ 16 --output-fmt bam \\\n    -f 0x001 -f 0x002 -F 0x004 -F 0x008 -q 20 \\\n    --fast \\\n    data/mapping/MNase_2.5min_R64-1-1_sorted.bam \\\n    -o data/mapping/MNase_2.5min_R64-1-1_sorted_filtered.bam\n\n## - Sorting read pairs\n#| -l 9: \"Use best compression \"\nsamtools sort \\\n    -@ 16 --output-fmt bam \\\n    -l 9 \\\n    data/mapping/MNase_2.5min_R64-1-1_sorted_filtered.bam \\\n    -o data/mapping/MNase_2.5min_R64-1-1_sorted_filtered_sorted.bam\n\n## - Indexing bam file\nsamtools index -@ 16 data/mapping/MNase_2.5min_R64-1-1_sorted_filtered_sorted.bam\n\n## - Generate coverage\nmkdir data/tracks\nbamCoverage \\\n    --bam data/mapping/MNase_2.5min_R64-1-1_sorted_filtered_sorted.bam \\\n    --outFileName data/tracks/MNase_2.5min_R64-1-1_sorted_filtered_sorted.CPM.bw \\\n    --binSize 1 \\\n    --numberOfProcessors 16 \\\n    --normalizeUsing CPM \\\n    --skipNonCoveredRegions \\\n    --extendReads"
  },
  {
    "objectID": "content/day2/Lecture3_workflows.html",
    "href": "content/day2/Lecture3_workflows.html",
    "title": "5  Lecture 3 - NGS processing workflows",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-5d0d9e50bf708684c2c6e57b56ae9e8c\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-0f086f9cda352bd420bab354be080b39\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day1/Lab1_MNase-seq_processing.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;4&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day2/Lecture4_ATACseq.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;6&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day2/Lecture4_ATACseq.html",
    "href": "content/day2/Lecture4_ATACseq.html",
    "title": "6  Lecture 4 - ATAC-seq processing and analyis",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-5d0d9e50bf708684c2c6e57b56ae9e8c\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-c9a86e879356478bd3d02c6c0e0636f1\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day2/Lecture3_workflows.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;5&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day2/Lecture5_R-101.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;7&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day2/Lecture5_R-101.html",
    "href": "content/day2/Lecture5_R-101.html",
    "title": "7  Lecture 5 - R 101",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-5d0d9e50bf708684c2c6e57b56ae9e8c\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-c9433669adab14652d2e950fd3bf23b3\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day2/Lecture4_ATACseq.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;6&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day2/Demo2_ATAC-seq_processing.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;8&lt;/span&gt;  &lt;span class='chapter-title'&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day2/Demo2_ATAC-seq_processing.html#align-reads-to-a-genome-reference",
    "href": "content/day2/Demo2_ATAC-seq_processing.html#align-reads-to-a-genome-reference",
    "title": "8  Demo 2 - Processing of ATAC-seq data",
    "section": "8.1 Align reads to a genome reference",
    "text": "8.1 Align reads to a genome reference\n\n8.1.1 Indexing WBcel235 genome\nGenome references for model systems can be fetched from iGenomes.\n\n\n\nsh\n\n## - Fetching data from iGenomes\ncurl -L http://igenomes.illumina.com.s3-website-us-east-1.amazonaws.com/Caenorhabditis_elegans/Ensembl/WBcel235/Caenorhabditis_elegans_Ensembl_WBcel235.tar.gz -o data/genome/WBcel235.tar.gz\n\n## - Unpacking data \ntar -C data/genome/ -xzf data/genome/WBcel235.tar.gz\ncp data/genome/Caenorhabditis_elegans//Ensembl/WBcel235/Sequence/WholeGenomeFasta/genome.fa data/genome/WBcel235.fa\ncp data/genome/Caenorhabditis_elegans//Ensembl/WBcel235/Annotation/Genes/genes.gtf data/genome/WBcel235.gtf\n\n## - Indexing genome\nbowtie2-build data/genome/WBcel235.fa data/genome/WBcel235\n\n\n\n\n8.1.2 Mapping paired-end reads\n\n\n\nsh\n\nfor REP in rep1 rep2\ndo\n    bowtie2 \\\n        --threads 16 \\\n        --maxins 2000 \\\n        -x data/genome/WBcel235 \\\n        -1 data/ATAC_\"${REP}\"_R1.fq.gz \\\n        -2 data/ATAC_\"${REP}\"_R2.fq.gz \\\n        &gt; data/mapping/ATAC_\"${REP}\"_WBcel235.sam\ndone\n\n\n\n\n8.1.3 Filtering mapped fragments\n\n\n\nsh\n\nSAMTOOLS_OPTIONS=\"-@ 12 --output-fmt bam\"\n\nfor REP in rep1 rep2\ndo\n    samtools fixmate \"${SAMTOOLS_OPTIONS}\" -m data/mapping/ATAC_\"${REP}\"_WBcel235.sam - | \\\n        samtools sort \"${SAMTOOLS_OPTIONS}\" - | \\\n        samtools markdup \"${SAMTOOLS_OPTIONS}\" -r - - | \\\n        samtools view \"${SAMTOOLS_OPTIONS}\" -q 20 --fast -b - | \\\n        samtools sort \"${SAMTOOLS_OPTIONS}\" -l 9 -o data/mapping/ATAC_\"${REP}\"_WBcel235.bam\n    samtools index -@ 12 data/mapping/ATAC_\"${REP}\"_WBcel235.bam\ndone\n\n\n\n\n8.1.4 Get tracks\n\n\n\nsh\n\nfor REP in rep1 rep2\ndo\n    bamCoverage \\\n        --bam data/mapping/ATAC_\"${REP}\"_WBcel235.bam \\\n        --outFileName data/tracks/ATAC_\"${REP}\"_WBcel235.bw \\\n        --binSize 1 \\\n        --numberOfProcessors 12 \\\n        --normalizeUsing CPM \\\n        --skipNonCoveredRegions \\\n        --extendReads \\\n        --ignoreDuplicates\ndone\n\n\n\n\n8.1.5 Get peaks\n\n\n\nsh\n\nmkdir data/peaks\nyapc data/peaks/ATAC_WBcel235 ATAC_WBcel235 data/tracks/ATAC_rep1_WBcel235.bw data/tracks/ATAC_rep2_WBcel235.bw\nhead data/peaks/ATAC_WBcel235_0.05.bed\ncut -f1-6 data/peaks/ATAC_WBcel235_0.05.bed | sed '1d' &gt; data/peaks/ATAC_WBcel235.bed"
  },
  {
    "objectID": "content/day2/Lab2_ATAC-seq_analysis.html#import-atac-seq-peaks-in-r",
    "href": "content/day2/Lab2_ATAC-seq_analysis.html#import-atac-seq-peaks-in-r",
    "title": "9  Lab 2 - ATAC-seq downstream analysis",
    "section": "9.1 Import ATAC-seq peaks in R",
    "text": "9.1 Import ATAC-seq peaks in R\n\nCheck documentation from the rtacklayer package to see how to import a bed file in R.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(rtracklayer)\npeaks &lt;- import('data/peaks/ATAC_WBcel235.bed', format = 'bed')\npeaks"
  },
  {
    "objectID": "content/day2/Lab2_ATAC-seq_analysis.html#import-atac-seq-fragments-in-r",
    "href": "content/day2/Lab2_ATAC-seq_analysis.html#import-atac-seq-fragments-in-r",
    "title": "9  Lab 2 - ATAC-seq downstream analysis",
    "section": "9.2 Import ATAC-seq fragments in R",
    "text": "9.2 Import ATAC-seq fragments in R\n\nCheck documentation from the Rsamtools package to see how to create a connection to disk-stored bam files.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(Rsamtools)\nbamfiles &lt;- BamFileList(list(\n    rep1 = BamFile('data/mapping/ATAC_rep1_WBcel235.bam'),\n    rep2 = BamFile('data/mapping/ATAC_rep2_WBcel235.bam') \n))\nbamfiles\n\n\n\n\n\n\nRead GenomicAlignments package documentation to see how to import fragments from a BamFile connection.\nImport fragments from paired-end reads, in proper pairs, no duplicates and no secondary alignments, with a MAPQ &gt;= 20. The important bam column to recover is isize (insert size).\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(GenomicAlignments)\nlibrary(tidyverse)\nparam &lt;- ScanBamParam(\n    flag=scanBamFlag(\n        isPaired = TRUE,\n        isProperPair = TRUE,\n        isDuplicate = FALSE,\n        isSecondaryAlignment = FALSE\n    ), \n    mapqFilter = 20, \n    what = c(\"isize\")\n)\nfrags &lt;- map(bamfiles, readGAlignmentPairs, param = param)\nfrags"
  },
  {
    "objectID": "content/day2/Lab2_ATAC-seq_analysis.html#check-distribution-of-atac-fragment-sizes",
    "href": "content/day2/Lab2_ATAC-seq_analysis.html#check-distribution-of-atac-fragment-sizes",
    "title": "9  Lab 2 - ATAC-seq downstream analysis",
    "section": "9.3 Check distribution of ATAC fragment sizes",
    "text": "9.3 Check distribution of ATAC fragment sizes\n\nCoerce fragments to GRanges with the as function.\nSubset fragments to retain those overlapping imported ATAC-seq peaks.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(GenomicRanges)\nfrags &lt;- map(frags, as, \"GRanges\")\nfrags &lt;- map(frags, subsetByOverlaps, peaks)\n\n\n\n\n\n\nPlot the width distribution for filtered ATAC-seq fragments.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\ndf &lt;- map_dfr(frags, as_tibble) |&gt; \n    group_by(width) |&gt; \n    tally()\nggplot(df, aes(x = width, y = n)) + geom_line() + xlim(c(0, 600))\n\n\n\n\n\n\nHow can you interpret the resulting distribution?"
  },
  {
    "objectID": "content/day2/Lab2_ATAC-seq_analysis.html#import-regulatory-elements-in-r",
    "href": "content/day2/Lab2_ATAC-seq_analysis.html#import-regulatory-elements-in-r",
    "title": "9  Lab 2 - ATAC-seq downstream analysis",
    "section": "9.4 Import regulatory elements in R",
    "text": "9.4 Import regulatory elements in R\nA comprehensive set of regulatory elements in C. elegans is provided here: https://genome.cshlp.org/content/suppl/2020/11/16/gr.265934.120.DC1/Supplemental_Table_S2.xlsx.\n\nCheck documentation from the readxl package to see how to import a xlsx file in R.\nCheck documentation from the GenomicRanges package to see how to convert a data.frame into a GRanges.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(readxl)\ndownload.file('https://genome.cshlp.org/content/suppl/2020/11/16/gr.265934.120.DC1/Supplemental_Table_S2.xlsx', 'data/WBcel235_REs.xlsx')\nREs &lt;- read_xlsx('data/WBcel235_REs.xlsx', skip = 2, col_names = TRUE)\nREs &lt;- makeGRangesFromDataFrame(\n    REs, seqnames.field = 'chrom_ce11', \n    start.field = 'start_ce11', end.field = 'end_ce11',\n    keep.extra.columns = TRUE\n)\nREs\n\n\n\n\n\nThe sequence names (or seqlevels) are not exactly the same in REs and peaks. This can be modified by changing the seqlevelsStyle of one of the two objects.\n\n\n\nR\n\nseqlevelsStyle(REs)\nseqlevelsStyle(peaks)\nseqlevelsStyle(REs) &lt;- seqlevelsStyle(peaks)"
  },
  {
    "objectID": "content/day2/Lab2_ATAC-seq_analysis.html#compare-peaks-and-res",
    "href": "content/day2/Lab2_ATAC-seq_analysis.html#compare-peaks-and-res",
    "title": "9  Lab 2 - ATAC-seq downstream analysis",
    "section": "9.5 Compare peaks and REs",
    "text": "9.5 Compare peaks and REs\n\nNow, check how many peaks overlap with REs.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\ntable(peaks %over% REs)\n\n\n\n\n\n\nCheck how many peaks overlap with germline-specific REs.\nPerform a fisher.test to evaluate whether this significantly overlaps.\nCan you speculate on the origin of the ATAC-seq dataset?\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nREs$is_germline_specific &lt;- REs$Annotation == 'Germline'\ntable(REs %over% peaks, REs$is_germline_specific) |&gt; fisher.test()"
  },
  {
    "objectID": "content/day3/Lecture6_ChIPseq.html",
    "href": "content/day3/Lecture6_ChIPseq.html",
    "title": "10  Lecture 6 - ChIP-seq processing and analyis",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-223e2965264ed5a7335008666fb8bf98\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-fc06f3d63979df8e2ab6705d5d00ef8f\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day2/Lab2_ATAC-seq_analysis.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;9&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day3/Lecture7_R-201.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;11&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day3/Lecture7_R-201.html",
    "href": "content/day3/Lecture7_R-201.html",
    "title": "11  Lecture 7 - R 201",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-223e2965264ed5a7335008666fb8bf98\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-597380fd1f2e33b98957388e3031f8da\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day3/Lecture6_ChIPseq.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;10&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day3/Demo3_ChIP-seq_processing.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;12&lt;/span&gt;  &lt;span class='chapter-title'&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day3/Demo3_ChIP-seq_processing.html#getting-data",
    "href": "content/day3/Demo3_ChIP-seq_processing.html#getting-data",
    "title": "12  Demo 3 - Processing of ChIP-seq data",
    "section": "12.1 Getting data",
    "text": "12.1 Getting data\n\n12.1.1 Downloading reads from internet\nWe can download the single-end reads directly from the internet.\n\n\n\nsh\n\ncd ~/EpigenomicsDataAnalysis_2023\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR110/000/SRR1103930/SRR1103930.fastq.gz -o data/Scc1_IP.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR110/008/SRR1103928/SRR1103928.fastq.gz -o data/Scc1_Inp.fq.gz\n\n\n\n\n12.1.2 FastQC reads\nfastqc program will run quick QCs on each fastq file separately.\n\n\n\nsh\n\nfastqc \\\n    --outdir data/fastqc \\\n    --noextract \\\n    --threads 12 \\\n    --adapters /home/rsg/repos/autobcl2fastq/adapters.txt \\\n    data/Scc1*fq.gz 1&gt;&2"
  },
  {
    "objectID": "content/day3/Demo3_ChIP-seq_processing.html#align-reads-to-a-genome-reference",
    "href": "content/day3/Demo3_ChIP-seq_processing.html#align-reads-to-a-genome-reference",
    "title": "12  Demo 3 - Processing of ChIP-seq data",
    "section": "12.2 Align reads to a genome reference",
    "text": "12.2 Align reads to a genome reference\n\n12.2.1 Mapping single-end IP and input reads\n\n\n\nsh\n\nfor FILE in IP Inp\ndo\n    bowtie2 \\\n        --threads 16 \\\n        -x data/genome/R64-1-1 \\\n        -U data/Scc1_\"${FILE}\".fq.gz \\\n        &gt; data/mapping/Scc1_\"${FILE}\"_R64-1-1.sam\ndone\n\n\n\n\n12.2.2 Filtering mapped fragments\n\n\n\nsh\n\nSAMTOOLS_OPTIONS=\"-@ 12 --output-fmt bam\"\n\nfor FILE in IP Inp\ndo\n    samtools sort \"${SAMTOOLS_OPTIONS}\" data/mapping/Scc1_\"${FILE}\"_R64-1-1.sam | \\\n        samtools markdup \"${SAMTOOLS_OPTIONS}\" -r - - | \\\n        samtools view \"${SAMTOOLS_OPTIONS}\" -q 20 --fast -b - | \\\n        samtools sort \"${SAMTOOLS_OPTIONS}\" -l 9 -o data/mapping/Scc1_\"${FILE}\"_R64-1-1.bam\n    samtools index -@ 12 data/mapping/Scc1_\"${FILE}\"_R64-1-1.bam\ndone\n\n\n\n\n12.2.3 Create coverage track\n\n\n\nsh\n\nfor FILE in IP Inp\ndo\n    bamCoverage \\\n        --bam data/mapping/Scc1_\"${FILE}\"_R64-1-1.bam \\\n        --outFileName data/tracks/Scc1_\"${FILE}\"_R64-1-1.CPM.bw \\\n        --binSize 1 \\\n        --numberOfProcessors 16 \\\n        --normalizeUsing CPM \\\n        --skipNonCoveredRegions \\\n        --extendReads 220\ndone\n\n\n\n\n12.2.4 Create IP/inp track\n\n\n\nsh\n\nbamCompare \\\n    -b1 data/mapping/Scc1_IP_R64-1-1.bam \\\n    -b2 data/mapping/Scc1_Inp_R64-1-1.bam \\\n    --outFileName data/tracks/Scc1_IP-vs-Inp.log2.bw \\\n    --scaleFactorsMethod readCount \\\n    --operation log2 \\\n    --skipZeroOverZero \\\n    --skipNonCoveredRegions \\\n    --skipNAs \\\n    --numberOfProcessors 16 \\\n    --binSize 1 \\\n    --extendReads 220 \n\n\n\n\n12.2.5 Call peaks with macs2\n\n\n\nsh\n\nmacs2 callpeak \\\n    -t data/mapping/Scc1_IP_R64-1-1.bam \\\n    -c data/mapping/Scc1_Inp_R64-1-1.bam \\\n    --format BAM \\\n    --nomodel --extsize 220 \\\n    --gsize 13000000 \\\n    --outdir data/peaks/ \\\n    --name Scc1_IP-vs-Inp"
  },
  {
    "objectID": "content/day3/Lab3_ChIP-seq_analysis.html#download-peaks-from-encode-database",
    "href": "content/day3/Lab3_ChIP-seq_analysis.html#download-peaks-from-encode-database",
    "title": "13  Lab 3 - ChIP-seq downstream analysis",
    "section": "13.1 Download peaks from ENCODE database",
    "text": "13.1 Download peaks from ENCODE database\nCheck out the modENCODE/modERN TF ChIP-seq database.\nInspect the available datasets, by filtering e.g. using the following criteria:\n\nAssay title: TF ChIP-seq\nOrganism: C. elegans\nGenome assembly: ce11\nProject: modENCODE\n\nPeak files for 12 ChIP-seq datasets have been already downloaded from this database."
  },
  {
    "objectID": "content/day3/Lab3_ChIP-seq_analysis.html#find-motifs-enriched-in-xnd-1-chip-seq",
    "href": "content/day3/Lab3_ChIP-seq_analysis.html#find-motifs-enriched-in-xnd-1-chip-seq",
    "title": "13  Lab 3 - ChIP-seq downstream analysis",
    "section": "13.2 Find motifs enriched in xnd-1 ChIP-seq",
    "text": "13.2 Find motifs enriched in xnd-1 ChIP-seq\n\nCheck the meme website to identify which tool is best suited to identify a motif de novo in a set of peaks from a ChIP-seq experiment.\nWhat do you need to run xstreme on a set of peaks?\n\n\n13.2.1 Preparing meme input\n\nImport xnd-1 peaks in R as a GRanges object.\nRecover ce11 genome sequence using the BSgenome.Celegans.UCSC.ce11 package.\nExtract sequence over xnd-1 peaks with the Biostrings package.\nExport the sequences as a fasta file.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nr\n\nlibrary(rtracklayer)\nlibrary(Biostrings)\nlibrary(BSgenome.Celegans.UCSC.ce11)\nxnd1 &lt;- import('data/peaks/modENCODE/xnd-1.bed')\ngenome &lt;- BSgenome.Celegans.UCSC.ce11\nxnd1_seq &lt;- getSeq(genome, xnd1)\nnames(xnd1_seq) &lt;- as.character(xnd1)\nwriteXStringSet(xnd1_seq, 'data/peaks/modENCODE/xnd-1.fa')\n\n\n\n\n\n\n\n13.2.2 Running meme\n\nIdentify motifs enriched in xnd-1 peaks with xstreme using the following options:\n\nZero or one occurence per sequence at most for meme\nAt most 3 motifs\nA min motif width of 6 for meme\nA max motif width of 15 for meme\nNo streme motifs\nOver multiple processors in parallel\n\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nsh\n\nxstreme \\\n    --p data/peaks/modENCODE/xnd-1.fa \\\n    --o data/meme/ \\\n    -minw 12 \\\n    -maxw 16 \\\n    --meme-nmotifs 3 \\\n    --meme-p 12 \\\n    --meme-mod zoops \\\n    --streme-nmotifs 0\n\n\n\n\n\n\nCheck the results. Do they make sense in the light of recent publications? (see here)"
  },
  {
    "objectID": "content/day3/Lab3_ChIP-seq_analysis.html#compare-all-peaks-to-genomic-features",
    "href": "content/day3/Lab3_ChIP-seq_analysis.html#compare-all-peaks-to-genomic-features",
    "title": "13  Lab 3 - ChIP-seq downstream analysis",
    "section": "13.3 Compare all peaks to genomic features",
    "text": "13.3 Compare all peaks to genomic features\n\n13.3.1 Import all peaks in R\n\nIn R, list all the bed files available for the peaks.\nImport each file as a GRanges object.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nr\n\nlibrary(rtracklayer)\nlibrary(tidyverse)\nbedfiles &lt;- list.files('data/peaks/modENCODE/', pattern = '*bed')\npeaks &lt;- map(bedfiles, ~ import(file.path('data/peaks/modENCODE/', .x)))\nnames(peaks) &lt;- str_replace(bedfiles, '.bed', '')\n\n\n\n\n\n\n\n13.3.2 Define genomic features in ce11\nGenomic features can be easily annotated from a set of gene features. ChIPseeker facilitates the annotation of ChIP-seq peaks using gene annotations directly provided in R by TxDb gene annotation packages, e.g. TxDb.Celegans.UCSC.ce11.ensGene\n\nInstall the TxDb.Celegans.UCSC.ce11.ensGene package in R\nInstall ChIPseeker\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nr\n\nBiocManager::install('TxDb.Celegans.UCSC.ce11.ensGene')\nBiocManager::install('ChIPseeker')\nlibrary(ChIPseeker)\nlibrary(TxDb.Celegans.UCSC.ce11.ensGene)\n\n\n\n\n\n\n\n13.3.3 ChIP-seq peak overlaps with genomic features\n\nUse ChIPseeker to annotate ChIP-seq peaks for a single ChIP-seq experiment.\nExtract\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nr\n\nceh48 &lt;- peaks[[1]]\nannots_ceh48 &lt;- annotatePeak(ceh48, TxDb = TxDb.Celegans.UCSC.ce11.ensGene)\ngetAnnoStat(annots_ceh48)\n\n\n\n\n\n\nIterate over all the peak sets to compile their annotations across C. elegans genome. To iterate over each set of peaks in the peaks list and return an aggregate data.frame, use the imap_dfr.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nr\n\nannots &lt;- imap_dfr(peaks, ~ annotatePeak(.x, TxDb = TxDb.Celegans.UCSC.ce11.ensGene) |&gt; \n    getAnnoStat() |&gt; \n    mutate(TF = .y)\n)\nannots\n\n\n\n\n\n\nGenerate a barplot to represent the % of peaks in each type of genomic features, for the 12 TFs.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nr\n\nggplot(annots, aes(x = TF, y = Frequency, fill = Feature)) + \n    geom_col() + \n    guides(x =  guide_axis(angle = 90))\n\n\n\n\n\n\nComment on the distribution of the 12 sets of peaks over genomic features.\n\n\n\n13.3.4 Peaks occurrence over tissue-specific regulatory elements\n\nImport regulatory elements annotated in C. elegans in R, as seen in previous Lab.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(readxl)\ndownload.file('https://genome.cshlp.org/content/suppl/2020/11/16/gr.265934.120.DC1/Supplemental_Table_S2.xlsx', 'data/WBcel235_REs.xlsx')\nREs &lt;- read_xlsx('data/WBcel235_REs.xlsx', skip = 2, col_names = TRUE)\nREs &lt;- makeGRangesFromDataFrame(\n    REs, seqnames.field = 'chrom_ce11', \n    start.field = 'start_ce11', end.field = 'end_ce11',\n    keep.extra.columns = TRUE\n)\nREs\n\n\n\n\n\n\nCheck for overlap of each regulatory element with xnd-1 peaks.\nCheck the overlap of germline-specific regulatory element with xnd-1 peaks.\nCheck the enrichment of germline-specific regulatory element over xnd-1 peaks.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\ntable(REs %over% peaks[['xnd-1']])\ntable(REs %over% peaks[['xnd-1']], REs$Annotation)\ntable(REs %over% peaks[['xnd-1']], REs$Annotation == 'Germline') \ntable(REs %over% peaks[['xnd-1']], REs$Annotation == 'Germline') |&gt; fisher.test()\n\n\n\n\n\n\nFor each tissue (Germline, Neurons, Muscle, Hypod. and Intest.), check whether the tissue-specific REs are enriched in xnd-1 peak.\n\n\n\n\n\n\n\nTip\n\n\n\n\nYou can iterate over each tissue and return an aggregated data.frame using map_dfr.\nFor each iteration, you can transform the result of fisher.test() into a tibble with the glance function from broom package.\n\n\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\ntissues &lt;- c(\"Germline\", \"Neurons\", \"Muscle\", \"Hypod.\", \"Intest.\")\ndf &lt;- map_dfr(tissues, function(tissue) {\n    fisher.test(\n        REs %over% peaks[['xnd-1']], \n        REs$Annotation == tissue\n    ) |&gt; \n        broom::glance() |&gt; \n        mutate(tissue = tissue, TF = 'xnd-1') |&gt; \n        dplyr::select(tissue, TF, estimate, p.value)\n})\n\n\n\n\n\n\nPerform the same operation by iterating over each peak set in the list of imported peaks.\n\n\n\n\n\n\n\nTip\n\n\n\n\nYou can use two nested map_dfr, iterating first over each TF then over each tissue.\n\n\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nTFs &lt;- names(peaks)\ntissues &lt;- c(\"Germline\", \"Neurons\", \"Muscle\", \"Hypod.\", \"Intest.\")\ndf &lt;- map_dfr(TFs, function(TF) {\n    map_dfr(tissues, function(tissue) {\n        fisher.test(\n            REs %over% peaks[[TF]], \n            REs$Annotation == tissue\n        ) |&gt; \n            broom::glance() |&gt; \n            mutate(tissue = tissue, TF = TF) |&gt; \n            dplyr::select(tissue, TF, estimate, p.value)\n    })\n})\n\n\n\n\n\n\nFor each TF, filter the tissues in which it is preferentially enriched (odds ratio &gt;= 2, p.value &lt;= 0.05)\nFind TFs enriched over Intestine REs\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nfilter(df, estimate &gt;= 2, p.value &lt;= 0.05)\nfilter(df, estimate &gt;= 2, p.value &lt;= 0.05, tissue == \"Intest.\")\n\n\n\n\n\n\nCheck the STRING DB website to assess whether these TFs have been shown to interact together. Comment."
  },
  {
    "objectID": "content/day4/Lecture8_RNAseq.html",
    "href": "content/day4/Lecture8_RNAseq.html",
    "title": "14  Lecture 8 - RNA-seq processing and analyis",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-df06f69911ab808ad1be095f974e0508\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-2cd1bd85fbcc1f4ce38b6b5a5aafdc4d\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day3/Lab3_ChIP-seq_analysis.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;13&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day4/Lecture9_R-301.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;15&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day4/Lecture9_R-301.html",
    "href": "content/day4/Lecture9_R-301.html",
    "title": "15  Lecture 9 - R 301",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-df06f69911ab808ad1be095f974e0508\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-888f276d774e079be435ab327266a4d8\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day4/Lecture8_RNAseq.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;14&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day4/Demo4_RNA-seq_processing.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;16&lt;/span&gt;  &lt;span class='chapter-title'&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day4/Demo4_RNA-seq_processing.html#indexing-genome-for-star-index",
    "href": "content/day4/Demo4_RNA-seq_processing.html#indexing-genome-for-star-index",
    "title": "16  Demo 4 - Processing of RNA-seq data",
    "section": "16.1 Indexing genome for STAR index",
    "text": "16.1 Indexing genome for STAR index\n\n\n\nsh\n\nSTAR \\\n    --runThreadN 12 \\\n    --runMode genomeGenerate \\\n    --genomeDir data/genome/ \\\n    --genomeFastaFiles data/genome/R64-1-1.fa \\\n    --sjdbGTFfile data/genome/R64-1-1.gtf \\\n    --sjdbOverhang 99"
  },
  {
    "objectID": "content/day4/Demo4_RNA-seq_processing.html#mapping-rna-seq-on-r64-1-1",
    "href": "content/day4/Demo4_RNA-seq_processing.html#mapping-rna-seq-on-r64-1-1",
    "title": "16  Demo 4 - Processing of RNA-seq data",
    "section": "16.2 Mapping RNA-seq on R64-1-1",
    "text": "16.2 Mapping RNA-seq on R64-1-1\n\n\n\nsh\n\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/003/SRR9929263/SRR9929263_1.fastq.gz -o data/RNAseq_WT_rep1_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/003/SRR9929263/SRR9929263_2.fastq.gz -o data/RNAseq_WT_rep1_R2.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/004/SRR9929264/SRR9929264_1.fastq.gz -o data/RNAseq_WT_rep2_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/004/SRR9929264/SRR9929264_2.fastq.gz -o data/RNAseq_WT_rep2_R2.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/003/SRR9929273/SRR9929273_1.fastq.gz -o data/RNAseq_WT_rep3_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/003/SRR9929273/SRR9929273_2.fastq.gz -o data/RNAseq_WT_rep3_R2.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/002/SRR9929282/SRR9929282_1.fastq.gz -o data/RNAseq_WT_rep4_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/002/SRR9929282/SRR9929282_2.fastq.gz -o data/RNAseq_WT_rep4_R2.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/001/SRR9929271/SRR9929271_1.fastq.gz -o data/RNAseq_HS_rep1_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/001/SRR9929271/SRR9929271_2.fastq.gz -o data/RNAseq_HS_rep1_R2.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/005/SRR9929265/SRR9929265_1.fastq.gz -o data/RNAseq_HS_rep2_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/005/SRR9929265/SRR9929265_2.fastq.gz -o data/RNAseq_HS_rep2_R2.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/000/SRR9929280/SRR9929280_1.fastq.gz -o data/RNAseq_HS_rep3_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/000/SRR9929280/SRR9929280_2.fastq.gz -o data/RNAseq_HS_rep3_R2.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/004/SRR9929274/SRR9929274_1.fastq.gz -o data/RNAseq_HS_rep4_R1.fq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR992/004/SRR9929274/SRR9929274_2.fastq.gz -o data/RNAseq_HS_rep4_R2.fq.gz\n\nfor REP in WT_rep1 WT_rep2 WT_rep3 WT_rep4 HS_rep1 HS_rep2 HS_rep3 HS_rep4\ndo \n\n    STAR \\\n        --genomeDir data/genome \\\n        --readFilesCommand zcat \\\n        --runThreadN 12 \\\n        --readFilesIn data/RNAseq_\"${REP}\"_R1.fq.gz data/RNAseq_\"${REP}\"_R2.fq.gz \\\n        --outFileNamePrefix data/mapping/RNAseq_\"${REP}\"_ \\\n        --outSAMtype BAM Unsorted \\\n        --outSAMunmapped None \\\n        --outSAMattributes Standard \n\n    samtools fixmate -@ 16 --output-fmt bam -m data/mapping/RNAseq_\"${REP}\"_Aligned.out.bam - \\\n        | samtools sort -@ 16 --output-fmt bam - \\\n        | samtools markdup -@ 16 --output-fmt bam -r - - \\\n        | samtools view -@ 16 --output-fmt bam -f 0x001 -f 0x002 -F 0x004 -F 0x008 -q 20 -1 -b - \\\n        | samtools sort -@ 16 --output-fmt bam -l 9 -o data/mapping/RNAseq_\"${REP}\"_R64-1-1.bam\n\n    samtools index -@ 16 data/mapping/RNAseq_\"${REP}\"_R64-1-1.bam\n\n    bamCoverage \\\n        --bam data/mapping/RNAseq_\"${REP}\"_R64-1-1.bam \\\n        --outFileName data/tracks/RNAseq_\"${REP}\"_R64-1-1.unstranded.CPM.bw \\\n        --binSize 1 \\\n        --numberOfProcessors 16 \\\n        --normalizeUsing CPM \\\n        --skipNonCoveredRegions \\\n        --extendReads \\\n        --ignoreDuplicates\n\n    bamCoverage \\\n        --bam data/mapping/RNAseq_\"${REP}\"_R64-1-1.bam \\\n        --outFileName data/tracks/RNAseq_\"${REP}\"_R64-1-1.fwd.CPM.bw \\\n        --binSize 1 \\\n        --numberOfProcessors 16 \\\n        --normalizeUsing CPM \\\n        --skipNonCoveredRegions \\\n        --extendReads \\\n        --ignoreDuplicates \\\n        --filterRNAstrand forward\n\n    bamCoverage \\\n        --bam data/mapping/RNAseq_\"${REP}\"_R64-1-1.bam \\\n        --outFileName data/tracks/RNAseq_\"${REP}\"_R64-1-1.rev.CPM.bw \\\n        --binSize 1 \\\n        --numberOfProcessors 16 \\\n        --normalizeUsing CPM \\\n        --skipNonCoveredRegions \\\n        --extendReads \\\n        --ignoreDuplicates \\\n        --filterRNAstrand reverse\n\ndone"
  },
  {
    "objectID": "content/day4/Demo4_RNA-seq_processing.html#counting-reads-over-gene-annotations",
    "href": "content/day4/Demo4_RNA-seq_processing.html#counting-reads-over-gene-annotations",
    "title": "16  Demo 4 - Processing of RNA-seq data",
    "section": "16.3 Counting reads over gene annotations",
    "text": "16.3 Counting reads over gene annotations\n\n16.3.1 Counting reads over peaks\n\n\n\nsh\n\nmkdir data/counts \nfeatureCounts \\\n    -g gene_name \\\n    -s 2 \\\n    -p --countReadPairs \\\n    -T 12 \\\n    -a data/genome/R64-1-1.gtf \\\n    -o data/counts/RNAseq_counts.tsv \\\n    data/mapping/RNAseq_WT_rep1_R64-1-1.bam \\\n    data/mapping/RNAseq_WT_rep2_R64-1-1.bam \\\n    data/mapping/RNAseq_WT_rep3_R64-1-1.bam \\\n    data/mapping/RNAseq_WT_rep4_R64-1-1.bam"
  },
  {
    "objectID": "content/day4/Lab4_RNA-seq_analysis.html#counting-mapped-fragments-over-a-set-of-gene-annotations",
    "href": "content/day4/Lab4_RNA-seq_analysis.html#counting-mapped-fragments-over-a-set-of-gene-annotations",
    "title": "17  Lab 4 - RNA-seq downstream analysis",
    "section": "17.1 Counting mapped fragments over a set of gene annotations",
    "text": "17.1 Counting mapped fragments over a set of gene annotations\n\nCreate a tibble containing the following information for the four RNA-seq samples (bam files provided in the shared Google Drive):\n\nPath to local bam file\nThe biological sample it corresponds to (e.g. WT, HS)\nThe biological replicate it corresponds to (e.g. rep1, rep2, …)\n\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(tidyverse)\nsamples &lt;- tibble(\n    bam = list.files('data/mapping', pattern = 'RNAseq.*_R64-1-1.bam$', full.names = TRUE), \n    sample = basename(bam), \n) |&gt; separate(sample, sep = '_', into = c('type', 'sample', 'rep', 'genome'))\n\n\n\n\n\n\nImport gene annotations downloaded on Monday for yeast.\nFilter it out to only keep transcripts\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(rtracklayer)\ngenes &lt;- import('data/genome/R64-1-1.gtf')\ngenes &lt;- genes[genes$type == 'transcript']\nnames(genes) &lt;- genes$gene_name\n\n\n\n\n\n\nCheck the summarizeOverlaps() function from the GenomicAlignments package.\nRun it to compute transcript abundance for all transcripts across the four replicates of the two samples.\nSpecify BPPARAM argument to perform RNA counting over multiple CPUs.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(Rsamtools)\nlibrary(GenomicAlignments)\nlibrary(SummarizedExperiment)\nlibrary(BiocParallel)\nRNAseq_counts &lt;- summarizeOverlaps(\n    reads = BamFileList(samples$bam), \n    features = genes, \n    singleEnd = FALSE, \n    fragments = TRUE,\n    BPPARAM = MulticoreParam(workers = length(samples$bam), progressbar = TRUE)\n)\ncolData(RNAseq_counts) &lt;- DataFrame(samples)"
  },
  {
    "objectID": "content/day4/Lab4_RNA-seq_analysis.html#differential-expression-analysis",
    "href": "content/day4/Lab4_RNA-seq_analysis.html#differential-expression-analysis",
    "title": "17  Lab 4 - RNA-seq downstream analysis",
    "section": "17.2 Differential expression analysis",
    "text": "17.2 Differential expression analysis\n\nRead DESeq documentation (?DESeq). What type of object does it require? How can you create one?\nCreate a DESeqDataSet object from the RNA counts. Choose your design formula appropriately.\nRun DESeq workflow\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(DESeq2)\ndds &lt;- DESeqDataSet(RNAseq_counts, design = ~ sample)\ndds &lt;- DESeq(dds)\n\n\n\n\n\n\nCheck the documentation for the results function from DESeq2 package.\nExtract the results of differential expression analysis, for the appropriate contrast.\nRecover genes over-expressed in heat-shock vs. control growth (fold-change &gt;= 2, p-value &lt;= 0.01)\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nres &lt;- results(dds, contrast = c('sample', 'HS', 'WT'))\nupreg_genes &lt;- res |&gt; \n    as_tibble(rownames = 'gene') |&gt; \n    filter(log2FoldChange &gt; 1, padj &lt;= 0.01) |&gt; \n    pull(gene)"
  },
  {
    "objectID": "content/day4/Lab4_RNA-seq_analysis.html#gene-ontology-over-enrichment-analysis",
    "href": "content/day4/Lab4_RNA-seq_analysis.html#gene-ontology-over-enrichment-analysis",
    "title": "17  Lab 4 - RNA-seq downstream analysis",
    "section": "17.3 Gene ontology over-enrichment analysis",
    "text": "17.3 Gene ontology over-enrichment analysis\n\nPerform gene ontology enrichment analysis using the gprofiler2 package.\nFrom the results, recover GO terms from the KEGG database and extract the most enriched terms\nComment\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\ngo &lt;- gprofiler2::gost(genes, organism = 'scerevisiae')\ngo$result |&gt; filter(source == 'KEGG') |&gt; arrange(p_value)"
  },
  {
    "objectID": "content/day5/Lecture10_HiC.html",
    "href": "content/day5/Lecture10_HiC.html",
    "title": "18  Lecture 10 - HiC processing",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-b37043dfa5cf1c205558e40d1a3efbd7\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-ef22c18da11d56da68ad1823e2d67585\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day4/Lab4_RNA-seq_analysis.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;17&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day5/Lecture11_GO-GSEA.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;19&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day5/Lecture11_GO-GSEA.html",
    "href": "content/day5/Lecture11_GO-GSEA.html",
    "title": "19  Lecture 11 - GO and GSEA analysis",
    "section": "",
    "text": "&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/program.html\"&gt;Program&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/Rstudio.html\"&gt;RStudio&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/prerequisites.html\"&gt;Prerequisites&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"&gt;Day 1&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture1_introduction.html\"&gt;&lt;span class=\"chapter-number\"&gt;1&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 1 - Introduction to epigenomics data analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lecture2_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;2&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 2 - General processing of genome-wide epigenomic assays&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Demo1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;3&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day1/Lab1_MNase-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;4&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 1 - Processing of MNase-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"&gt;Day 2&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture3_workflows.html\"&gt;&lt;span class=\"chapter-number\"&gt;5&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 3 - NGS processing workflows&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture4_ATACseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;6&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 4 - ATAC-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lecture5_R-101.html\"&gt;&lt;span class=\"chapter-number\"&gt;7&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 5 - R 101&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Demo2_ATAC-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;8&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 2 - Processing of ATAC-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day2/Lab2_ATAC-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;9&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 2 - ATAC-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-3\"&gt;Day 3&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture6_ChIPseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;10&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 6 - ChIP-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lecture7_R-201.html\"&gt;&lt;span class=\"chapter-number\"&gt;11&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 7 - R 201&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Demo3_ChIP-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;12&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 3 - Processing of ChIP-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day3/Lab3_ChIP-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;13&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 3 - ChIP-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-4\"&gt;Day 4&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture8_RNAseq.html\"&gt;&lt;span class=\"chapter-number\"&gt;14&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 8 - RNA-seq processing and analyis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lecture9_R-301.html\"&gt;&lt;span class=\"chapter-number\"&gt;15&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 9 - R 301&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Demo4_RNA-seq_processing.html\"&gt;&lt;span class=\"chapter-number\"&gt;16&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 4 - Processing of RNA-seq data&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day4/Lab4_RNA-seq_analysis.html\"&gt;&lt;span class=\"chapter-number\"&gt;17&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 4 - RNA-seq downstream analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:quarto-sidebar-section-5\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture10_HiC.html\"&gt;&lt;span class=\"chapter-number\"&gt;18&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lecture11_GO-GSEA.html\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Demo5_Bioc-resources.html\"&gt;&lt;span class=\"chapter-number\"&gt;20&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/day5/Lab5_data-integration.html\"&gt;&lt;span class=\"chapter-number\"&gt;21&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lab 5 - Multi-omics data integration&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/content/extra.html\"&gt;Extra resources&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;Epigenomics Data Analysis |&lt;br /&gt;\nJ. Serizay&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-b37043dfa5cf1c205558e40d1a3efbd7\"&gt;Day 5&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-d3cf21689d757686b1f0179f16429e12\"&gt;&lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-metatitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;Epigenomics Data Analysis - &lt;span class=\"chapter-number\"&gt;19&lt;/span&gt;  &lt;span class=\"chapter-title\"&gt;Lecture 11 - GO and GSEA analysis&lt;/span&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Epigenomics Data Analysis&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;nav class=\"page-navigation\"&gt;\n  &lt;div class=\"nav-page nav-page-previous\"&gt;\n      &lt;a  href=\"/content/day5/Lecture10_HiC.html\" class=\"pagination-link\"&gt;\n        &lt;i class=\"bi bi-arrow-left-short\"&gt;&lt;/i&gt; &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;18&lt;/span&gt;  &lt;span class='chapter-title'&gt;Lecture 10 - HiC processing&lt;/span&gt;&lt;/span&gt;\n      &lt;/a&gt;          \n  &lt;/div&gt;\n  &lt;div class=\"nav-page nav-page-next\"&gt;\n      &lt;a  href=\"/content/day5/Demo5_Bioc-resources.html\" class=\"pagination-link\"&gt;\n        &lt;span class=\"nav-page-text\"&gt;&lt;span class='chapter-number'&gt;20&lt;/span&gt;  &lt;span class='chapter-title'&gt;Demo 5 - Leveraging Bioconductor resources&lt;/span&gt;&lt;/span&gt; &lt;i class=\"bi bi-arrow-right-short\"&gt;&lt;/i&gt;\n      &lt;/a&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;Epigenomics Data Analysis |  \nJ. Serizay\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This book was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "content/day5/Demo5_Bioc-resources.html#recover-hmm-based-chromatin-state-annotations-in-two-human-cell-lines",
    "href": "content/day5/Demo5_Bioc-resources.html#recover-hmm-based-chromatin-state-annotations-in-two-human-cell-lines",
    "title": "20  Demo 5 - Leveraging Bioconductor resources",
    "section": "20.1 Recover HMM-based chromatin state annotations in two human cell lines",
    "text": "20.1 Recover HMM-based chromatin state annotations in two human cell lines\nLeveraging AnnotationHub, I can recover chromatin state annotations from the Epigenome Roadmap project (published here) for two different cell lines.\n\nlibrary(tidyverse)\nlibrary(AnnotationHub)\nah &lt;- AnnotationHub()\nah_human_epigenome &lt;- query(ah, c(\"Homo sapiens\", \"EpigenomeRoadMap\"))\nepigenome_metadata &lt;- query(ah_human_epigenome, 'data.frame')[[1]]\nepigenome_metadata[1:10, 1:10]\nquery(ah_human_epigenome, c(\"chromhmmSegmentations\", \"cell line\"))\nH1_states &lt;- query(ah_human_epigenome, c(\"chromhmmSegmentations\", \"ESC.H1\"))[[1]]\nNPC_states &lt;- query(ah_human_epigenome, c(\"chromhmmSegmentations\", \"ESDR.H1.NEUR.PROG\"))[[1]]\nH1_states\nNPC_states"
  },
  {
    "objectID": "content/day5/Demo5_Bioc-resources.html#compare-state-annotations-in-two-human-cell-lines",
    "href": "content/day5/Demo5_Bioc-resources.html#compare-state-annotations-in-two-human-cell-lines",
    "title": "20  Demo 5 - Leveraging Bioconductor resources",
    "section": "20.2 Compare state annotations in two human cell lines",
    "text": "20.2 Compare state annotations in two human cell lines\nI can then compare how these two sets of annotations vary, to infer how chromatin states change througout a differentiation process.\n\nlibrary(plyranges)\nstates &lt;- c(\n    \"Active TSS\", \n    \"Flanking Active TSS\", \n    \"Bivalent/Poised TSS\", \n    \"Enhancers\",\n    \"Flanking Bivalent TSS/Enh\", \n    \"Strong transcription\",\n    \"Transcr. at gene 5' and 3'\", \n    \"Weak transcription\",\n    \"Bivalent Enhancer\", \n    \"Genic enhancers\",\n    \"Quiescent/Low\", \n    \"Heterochromatin\", \n    \"Weak Repressed PolyComb\", \n    \"Repressed PolyComb\", \n    \"ZNF genes & repeats\"\n)\nH1_states$H1_state &lt;- factor(H1_states$name, levels = states)\nH1_states$NPC_state &lt;- join_nearest(H1_states, NPC_states)$name.y |&gt; factor(levels = states)\ndf &lt;- tibble(\n    stateInH1 = H1_states$H1_state, \n    stateInNPCs = H1_states$NPC_state  \n) |&gt; \n    group_by(stateInH1, stateInNPCs) |&gt; \n    count() |&gt; \n    group_by(stateInH1) |&gt; \n    mutate(\n        total = sum(n), \n        pct = n/total\n    )\np &lt;- ggplot(df, aes(x = stateInH1, y = stateInNPCs, fill = pct)) + \n    geom_tile(col = \"black\") + \n    theme_bw() + \n    scale_fill_gradientn(colours = c('white', 'orange', 'darkred')) + \n    labs(\n        x = \"Chromatin states in H1 cells\", \n        y = \"Chromatin states in H1-derived\\nneural progenitor cells\", \n        fill = '# of genomic bins'\n    ) + \n    guides(x =  guide_axis(angle = 90)) +\n    coord_fixed()\n\n\ntransitioning_loci_1 &lt;- H1_states[H1_states$H1_state == 'Bivalent/Poised TSS' & H1_states$NPC_state == 'Active TSS']\ntransitioning_loci_2 &lt;- H1_states[H1_states$H1_state == 'Bivalent/Poised TSS' & H1_states$NPC_state == 'Repressed PolyComb']"
  },
  {
    "objectID": "content/day5/Demo5_Bioc-resources.html#recover-genes-associated-with-varying-chromatin-states",
    "href": "content/day5/Demo5_Bioc-resources.html#recover-genes-associated-with-varying-chromatin-states",
    "title": "20  Demo 5 - Leveraging Bioconductor resources",
    "section": "20.3 Recover genes associated with varying chromatin states",
    "text": "20.3 Recover genes associated with varying chromatin states\n\nquery(ah, c(\"Homo sapiens\", \"release-75\"))\nhuman_gtf &lt;- ah[['AH10684']]\nhuman_Ensembl_genes &lt;- human_gtf[human_gtf$type == 'gene' & human_gtf$gene_biotype == 'protein_coding']\nhuman_Ensembl_TSSs &lt;- resize(human_Ensembl_genes, 1, 'start')\nhuman_Ensembl_TSSs\nseqlevelsStyle(human_Ensembl_TSSs) &lt;- seqlevelsStyle(H1_states)\n#\nseqlevels(transitioning_loci_1, pruning.mode = 'coarse') &lt;- seqlevelsInUse(transitioning_loci_1)\nseqlevels(human_Ensembl_TSSs, pruning.mode = 'coarse') &lt;- seqlevels(transitioning_loci_1)\ntransitioning_loci_1 &lt;- join_nearest(transitioning_loci_1, human_Ensembl_TSSs, distance = TRUE)\ntransitioning_loci_2 &lt;- join_nearest(transitioning_loci_2, human_Ensembl_TSSs, distance = TRUE)"
  },
  {
    "objectID": "content/day5/Demo5_Bioc-resources.html#enriched-gene-ontology-terms-for-genes-associated-with-varying-chromatin-states",
    "href": "content/day5/Demo5_Bioc-resources.html#enriched-gene-ontology-terms-for-genes-associated-with-varying-chromatin-states",
    "title": "20  Demo 5 - Leveraging Bioconductor resources",
    "section": "20.4 Enriched gene ontology terms for genes associated with varying chromatin states",
    "text": "20.4 Enriched gene ontology terms for genes associated with varying chromatin states\n\ngenes &lt;- unique(transitioning_loci_1$gene_name[transitioning_loci_1$distance &lt;= 500]) \nres &lt;- gprofiler2::gost(genes, organism = 'hsapiens')\nas_tibble(res$result) |&gt;   \n    select(source, term_name, p_value, precision, recall) |&gt;\n    filter(source == \"GO:BP\",recall &gt;= 0.05) |&gt; \n    arrange(p_value) |&gt; \n    print(n = 50)\n\n\ngenes &lt;- unique(transitioning_loci_2$gene_name[transitioning_loci_2$distance &lt;= 500]) \nres &lt;- gprofiler2::gost(genes, organism = 'hsapiens')\nas_tibble(res$result) |&gt;   \n    select(source, term_name, p_value, precision, recall) |&gt;\n    filter(source == \"GO:BP\",recall &gt;= 0.05) |&gt; \n    arrange(p_value) |&gt; \n    print(n = 50)"
  },
  {
    "objectID": "content/day5/Lab5_data-integration.html#inspecting-data-in-igv",
    "href": "content/day5/Lab5_data-integration.html#inspecting-data-in-igv",
    "title": "21  Lab 5 - Multi-omics data integration",
    "section": "21.1 Inspecting data in IGV",
    "text": "21.1 Inspecting data in IGV\n\nOpen .bw files and the Scc1 ChIP-seq peak file in IGV.\nCompare the signal of stranded RNA-seq coverage tracks with the location of Scc1 peaks. Comment.\nCompare the location of transcription start sites (TSSs) with nucleosome profiles. Comment."
  },
  {
    "objectID": "content/day5/Lab5_data-integration.html#plotting-stranded-rna-seq-signal-over-scc1-chip-seq-peaks",
    "href": "content/day5/Lab5_data-integration.html#plotting-stranded-rna-seq-signal-over-scc1-chip-seq-peaks",
    "title": "21  Lab 5 - Multi-omics data integration",
    "section": "21.2 Plotting stranded RNA-seq signal over Scc1 ChIP-seq peaks",
    "text": "21.2 Plotting stranded RNA-seq signal over Scc1 ChIP-seq peaks\n\nLoad forward and reverse RNA-seq coverage as Rle in R\nLoad Scc1 peaks in R\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(tidyverse)\nlibrary(GenomicRanges)\nlibrary(rtracklayer)\nrna_fwd_track &lt;- import('data/day5/RNAseq.fwd.bw', as = 'Rle')\nrna_rev_track &lt;- import('data/day5/RNAseq.rev.bw', as = 'Rle')\nscc1_peaks &lt;- import('data/day5/Scc1.narrowPeak')\n\n\n\n\n\n\nResize Scc1 peaks so that they all are centered over their summit (check peak column from the narrowPeak file), and extend then ± 4000 bp\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nlibrary(plyranges)\nscc1_peaks &lt;- scc1_peaks |&gt; \n    resize(fix = 'start', width = 1) |&gt; \n    shift_right(scc1_peaks$peak) |&gt; \n    resize(fix = 'center', width = 8000)\n\n\n\n\n\n\nCompute a seqinfo from the rna_fwd_track Rle, add seqlengths and convert it into a GRanges object.\nRemove the extended Scc1 peaks that lie outside of genome boundaries. To do this, check the operators %over% and %within%.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\ngenome &lt;- seqinfo(rna_fwd_track)\nseqlengths(genome) &lt;- lengths(rna_fwd_track)\ngenome &lt;- as(genome, \"GRanges\")\ntable(scc1_peaks %over% genome)\ntable(scc1_peaks %within% genome)\nscc1_peaks &lt;- scc1_peaks[scc1_peaks %within% genome]\n\n\n\n\n\n\nExtract the forward RNA-seq coverage signal over the first Scc1 peak\nConvert it into a tibble and add coordinates (± 4000 bp centered over Scc1 peak)\nDo the same for reverse RNA-seq coverage\nPlot the two stranded RNA-seq coverages together\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nrna_fwd_track[scc1_peaks][[1]]\ndf &lt;- rna_fwd_track[scc1_peaks][[1]] |&gt; \n    as_tibble() |&gt;\n    mutate(position = seq(-3999, 4000, 1))\ndf$forward &lt;- df$value\ndf$reverse &lt;- rna_rev_track[scc1_peaks][[1]] |&gt; as.vector()\ndf$value &lt;- NULL\np &lt;- pivot_longer(df, -pos, names_to = 'strandness', values_to = 'coverage') |&gt;\n    ggplot(aes(x = pos, y = coverage, col = strandness)) + \n    geom_line()\n\n\n\n\n\n\nIterate over all Scc1 peaks to extract stranded RNA-seq coverage around Scc1 peaks\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\ndf &lt;- rna_fwd_track[scc1_peaks] |&gt;\n    as_tibble() |&gt; ## Convert into a data.frame\n    mutate(position = rep(seq(-3999, 4000, 1), length(scc1_peaks))) |&gt; ## Repeat the position (± 4000bp) as many times as the number of Scc1 peaks\n    mutate(forward = value) |&gt; \n    select(group, position, forward) |&gt; ## Tidy up columns\n    mutate(reverse = rna_rev_track[scc1_peaks] |&gt; unlist() |&gt; as.vector()) |&gt; ## Add reverse scores\n    pivot_longer(-c(group, position), names_to = 'strandness', values_to = 'coverage') |&gt;\n    group_by(position, strandness) \n\n\n\n\n\n\nCalculate mean, standard deviation and 95% confidence interval of forward and reverse RNA-seq coverage around Scc1 peaks\nPlot the average forward and reverse RNA-seq coverages, with a ribbon showing the 95% confidence interval.\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\naggr_df &lt;- summarize(df, \n    mean = mean(coverage), \n    sd = sd(coverage, na.rm = TRUE), \n    n = dplyr::n()\n) |&gt;\n    mutate(\n        se = sd / sqrt(n),\n        CI = qt(0.975, n-1) * se,\n        topMargin = mean + CI,\n        bottomMargin = mean - CI\n    )\np &lt;- ggplot(aggr_df, aes(x = position, y = mean, col = strandness, fill = strandness)) + \n    geom_line() + \n    geom_ribbon(aes(ymax = mean + CI, ymin = mean - CI), alpha = 0.2, col = NA)"
  },
  {
    "objectID": "content/day5/Lab5_data-integration.html#plot-a-heaetmap-of-rna-seq-coverage-over-ordered-scc1-peaks",
    "href": "content/day5/Lab5_data-integration.html#plot-a-heaetmap-of-rna-seq-coverage-over-ordered-scc1-peaks",
    "title": "21  Lab 5 - Multi-omics data integration",
    "section": "21.3 Plot a heaetmap of RNA-seq coverage over ordered Scc1 peaks",
    "text": "21.3 Plot a heaetmap of RNA-seq coverage over ordered Scc1 peaks\n\nOrder peaks according to their Scc1 peak signal\nRe-compute the stranded RNA-seq coverages around ordered Scc1 peaks\nPlot a (rasterized) heatmap using geom_tile(), with the distance from Scc1 peak in abscisse and each row representing an individual Scc1 peak locus. You can split forward and reverse coverage with facet_wrap(~ strandness).\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\nordered_scc1_peaks &lt;- scc1_peaks[order(scc1_peaks$signalValue, decreasing = TRUE)]\ndf &lt;- rna_fwd_track[ordered_scc1_peaks] |&gt;\n    as_tibble() |&gt; ## Convert into a data.frame\n    mutate(position = rep(seq(-3999, 4000, 1), length(ordered_scc1_peaks))) |&gt; ## Repeat the position (± 4000bp) as many times as the number of Scc1 peaks\n    mutate(forward = value) |&gt; \n    dplyr::select(group, position, forward) |&gt; ## Tidy up columns\n    mutate(reverse = rna_rev_track[ordered_scc1_peaks] |&gt; unlist() |&gt; as.vector()) |&gt; ## Add reverse scores\n    pivot_longer(-c(group, position), names_to = 'strandness', values_to = 'coverage') |&gt;\n    group_by(position, strandness) \np &lt;- ggplot(df, aes(x = position, y = group, fill = log2(coverage))) + \n    geom_tile() |&gt; ggrastr::rasterise() + \n    facet_wrap(~ strandness, scales = 'free') +\n    scale_y_reverse() +\n    scale_fill_gradientn(\n        colours = c(\"#FFFEF9\", \"#FFCA67\", \"#ED3024\", \"#1A0A10\"), \n        na.value = 'white'\n    )"
  },
  {
    "objectID": "content/day5/Lab5_data-integration.html#plot-stranded-rna-seq-coverages-for-scc1-peaks-grouped-by-their-strength",
    "href": "content/day5/Lab5_data-integration.html#plot-stranded-rna-seq-coverages-for-scc1-peaks-grouped-by-their-strength",
    "title": "21  Lab 5 - Multi-omics data integration",
    "section": "21.4 Plot stranded RNA-seq coverages for Scc1 peaks grouped by their strength",
    "text": "21.4 Plot stranded RNA-seq coverages for Scc1 peaks grouped by their strength\n\nGroup the coverage tibble in 4 groups, containing the 0-25% (weakest) peaks, then 25-50%, 50-75% and 75-100% (strongest) peaks. This can be done with the ntile function.\nRe-plot the average forward and reverse RNA-seq coverages, with a ribbon showing the 95% confidence interval, splitting the peaks from each group in a different facet (with facet_wrap(~ group)).\n\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\n\nR\n\ndf$signalValue &lt;- ordered_scc1_peaks$signalValue[df$group]\ndf$group &lt;- ntile(df$signalValue, 4)\naggr_df &lt;- group_by(df, group, position, strandness) |&gt;\n    summarize( \n        mean = mean(coverage), \n        sd = sd(coverage, na.rm = TRUE), \n        n = dplyr::n()\n    ) |&gt;\n    mutate(\n        se = sd / sqrt(n),\n        CI = qt(0.975, n-1) * se,\n        topMargin = mean + CI,\n        bottomMargin = mean - CI\n    )\np &lt;- ggplot(aggr_df, aes(x = position, y = mean, col = strandness, fill = strandness)) + \n    geom_line() + \n    geom_ribbon(aes(ymax = mean + CI, ymin = mean - CI), alpha = 0.2, col = NA) +\n    facet_wrap(~ group)"
  },
  {
    "objectID": "content/extra.html#general-bioinformatics",
    "href": "content/extra.html#general-bioinformatics",
    "title": "Extra resources",
    "section": "General bioinformatics",
    "text": "General bioinformatics\n\nA comprehensive overview of the different types of bioinformatic analyses, divided in 4 fundamental modules: LINK"
  },
  {
    "objectID": "content/extra.html#rbioconductor",
    "href": "content/extra.html#rbioconductor",
    "title": "Extra resources",
    "section": "R/Bioconductor",
    "text": "R/Bioconductor\n\nThe excellent R guide for beginners, by Emmanuel Paradis: PDF\nThe 150+ pages comprehensive book to learn everything about Bioconductor. This ebook has been published by Kasper D. Hansen and is freely available under the CC BY-NC-SA 4.0 license: Link to EPUB"
  },
  {
    "objectID": "content/extra.html#scientific-readings",
    "href": "content/extra.html#scientific-readings",
    "title": "Extra resources",
    "section": "Scientific readings",
    "text": "Scientific readings\n\n2014 Nat. Methods paper from Bioconductor core team describing important object classes\nTo see from how far Bioc comes from..."
  }
]